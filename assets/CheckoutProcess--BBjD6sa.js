import{g as r}from"./utils-DYUUmGX3.js";import{E as a}from"./ExternalServices-D9P6I627.js";const n=new a;function c(s){const o=new FormData(s),t={};return o.forEach((e,i)=>{t[i]=e}),t}function l(s){return s.map(t=>({id:t.Id,price:t.FinalPrice,name:t.Name,quantity:t.quantity}))}class m{constructor(o,t){this.key=o,this.outputSelector=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=r(this.key),this.calculateItemSummary()}calculateItemSummary(){const o=document.querySelector(this.outputSelector+" #cartTotal"),t=document.querySelector(this.outputSelector+" #num-items");t.innerText=this.list.reduce((e,i)=>e+i.quantity,0),this.itemTotal=this.list.reduce((e,i)=>e+i.FinalPrice*i.quantity,0),o.innerText=`$${this.itemTotal.toFixed(2)}`}calculateOrderTotal(){this.tax=this.itemTotal*.06;const o=this.list.reduce((t,e)=>t+e.quantity,0);this.shipping=10+(o-1)*2,this.orderTotal=parseFloat(this.itemTotal)+parseFloat(this.tax)+parseFloat(this.shipping),this.displayOrderTotals()}displayOrderTotals(){const o=document.querySelector(`${this.outputSelector} #tax`),t=document.querySelector(`${this.outputSelector} #shipping`),e=document.querySelector(`${this.outputSelector} #orderTotal`);o.innerText=`$${this.tax.toFixed(2)}`,t.innerText=`$${this.shipping.toFixed(2)}`,e.innerText=`$${this.orderTotal.toFixed(2)}`}async checkout(){const o=document.forms.checkout,t=c(o);t.orderDate=new Date().toISOString(),t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,t.items=l(this.list);try{const e=await n.checkout(t);console.log(e)}catch(e){console.log(e)}}}export{m as C};
